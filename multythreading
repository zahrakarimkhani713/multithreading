
import threading
import sqlite3
import time


def save_to_db(item):
    conn = sqlite3.connect("my_database.db")
    cursor = conn.cursor()
    cursor.execute("""
        CREATE TABLE IF NOT EXISTS items (
            id INTEGER PRIMARY KEY AUTOINCREMENT,
            value TEXT
        )
    """)

    cursor.execute("INSERT INTO items (value) VALUES (?)", (item,))
    conn.commit()
    conn.close()
    print(f"Saved item: {item}")
    


def process_item(item):
    
    time.sleep(1)
    save_to_db(item)


if __name__ == "__main__":
    list = ["a","b","d"]
    length = len(list)

    for i in range(0,length):
        t= threading.Thread(target = process_item , args=(list[i],))
        t.start()
        t.join()

    print("All items saved.")




